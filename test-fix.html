<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fix - SmashImpact</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
        #status {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 5px;
            font-size: 14px;
        }
        .success {
            color: #00ff00;
        }
        .error {
            color: #ff0000;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="status">
        <div id="test-results"></div>
    </div>
    
    <!-- Include the VFX system -->
    <script>
        // Minimal VFX system for particle effects
        class VFXSystem {
            constructor(ctx) {
                this.ctx = ctx;
                this.particles = [];
                this.screenShake = { intensity: 0, duration: 0 };
            }
            
            createParticle(x, y, vx, vy, color, lifetime) {
                this.particles.push({ x, y, vx, vy, color, lifetime, maxLifetime: lifetime });
            }
            
            createBoostTrail(x, y, color, velocity) {
                // Simplified implementation
            }
            
            createImpactEffect(x, y, color) {
                // Simplified implementation
            }
            
            createExplosion(x, y, color) {
                // Simplified implementation
            }
            
            createPowerUpEffect(x, y, type) {
                // Simplified implementation
            }
            
            shakeScreen(intensity, duration) {
                this.screenShake.intensity = intensity;
                this.screenShake.duration = duration;
            }
            
            startScreenShake(intensity, duration) {
                this.shakeScreen(intensity, duration);
            }
            
            update(deltaTime) {
                // Simplified implementation
            }
            
            render() {
                // Simplified implementation
            }
        }
        
        // Inject VFX into window for the game to use
        window.VFXSystem = VFXSystem;
    </script>
    
    <!-- Include the game -->
    <script src="public/unified-game.js"></script>
    
    <script>
        // Test the fix
        const canvas = document.getElementById('gameCanvas');
        const statusDiv = document.getElementById('test-results');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        let testResults = [];
        
        // Test 1: Check if UnifiedGame exists
        if (window.UnifiedGame) {
            testResults.push('<div class="success">✓ UnifiedGame class found</div>');
        } else {
            testResults.push('<div class="error">✗ UnifiedGame class not found</div>');
        }
        
        // Test 2: Create game instance
        let game;
        try {
            game = new window.UnifiedGame(canvas);
            testResults.push('<div class="success">✓ Game instance created successfully</div>');
        } catch (error) {
            testResults.push(`<div class="error">✗ Failed to create game instance: ${error.message}</div>`);
        }
        
        // Test 3: Check if start method exists
        if (game && typeof game.start === 'function') {
            testResults.push('<div class="success">✓ game.start() method exists</div>');
        } else {
            testResults.push('<div class="error">✗ game.start() method not found</div>');
        }
        
        // Test 4: Try to call start method
        if (game && typeof game.start === 'function') {
            try {
                game.start();
                testResults.push('<div class="success">✓ game.start() called successfully</div>');
                testResults.push('<div class="success">✓ All tests passed! The fix works correctly.</div>');
            } catch (error) {
                testResults.push(`<div class="error">✗ Error calling game.start(): ${error.message}</div>`);
            }
        }
        
        // Display results
        statusDiv.innerHTML = testResults.join('');
        
        // Handle window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>