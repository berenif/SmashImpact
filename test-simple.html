<!DOCTYPE html>
<html>
<head>
    <title>Simple QR Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        canvas { border: 1px solid #ccc; margin: 20px 0; }
        button { padding: 10px 20px; margin: 10px; }
    </style>
</head>
<body>
    <h1>Simple QR Code Test</h1>
    <button onclick="testQR()">Test QR Generation</button>
    <br>
    <canvas id="qrCanvas" width="300" height="300"></canvas>
    <div id="status"></div>

    <script src="./vendor/qrcode.js"></script>
    <script>
        function testQR() {
            try {
                const status = document.getElementById('status');
                const canvas = document.getElementById('qrCanvas');
                
                // Test basic QR functionality
                if (typeof window.qrcode !== 'function') {
                    status.textContent = '❌ QR library not loaded';
                    return;
                }
                
                status.textContent = '✅ QR library loaded, generating...';
                
                // Create QR code
                const qr = window.qrcode(1, 'L');
                qr.addData('Hello World! This is a test QR code.');
                qr.make();
                
                const count = qr.getModuleCount();
                const scale = 8;
                const size = count * scale;
                
                canvas.width = canvas.height = Math.max(300, size);
                const ctx = canvas.getContext('2d');
                
                // Clear canvas
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                const offset = Math.floor((canvas.width - size) / 2);
                
                // Draw QR code
                for (let r = 0; r < count; r++) {
                    for (let c = 0; c < count; c++) {
                        ctx.fillStyle = qr.isDark(r, c) ? '#000' : '#fff';
                        ctx.fillRect(offset + c * scale, offset + r * scale, scale, scale);
                    }
                }
                
                status.textContent = '✅ QR code generated successfully! Module count: ' + count;
                
            } catch (error) {
                document.getElementById('status').textContent = '❌ Error: ' + error.message;
                console.error('QR test error:', error);
            }
        }
        
        // Auto-test on load
        window.onload = function() {
            setTimeout(testQR, 500);
        };
    </script>
</body>
</html>