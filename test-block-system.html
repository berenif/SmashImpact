<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block System Test - SmashImpact</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
        #info {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 5px;
            font-size: 14px;
            line-height: 1.5;
        }
        #info h3 {
            margin: 0 0 10px 0;
            color: #00ff00;
        }
        .control {
            margin: 5px 0;
        }
        .key {
            background: #333;
            padding: 2px 6px;
            border-radius: 3px;
            display: inline-block;
            min-width: 20px;
            text-align: center;
            margin-right: 5px;
        }
        .perfect-parry {
            color: #ffdd00;
            font-weight: bold;
        }
        .normal-block {
            color: #4444ff;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="info">
        <h3>üõ°Ô∏è Block System Controls</h3>
        <div class="control">
            <span class="key">SHIFT</span> or <span class="key">SPACE</span> - Hold to Block
        </div>
        <div class="control">
            <span class="key">W/A/S/D</span> or <span class="key">‚Üë‚Üê‚Üì‚Üí</span> - Move
        </div>
        <div class="control">
            <span class="key">E</span> - Boost
        </div>
        <hr style="border-color: #333; margin: 10px 0;">
        <div class="perfect-parry">‚ö° Perfect Parry Window: 100ms</div>
        <div>Block within the golden window for:</div>
        <ul style="margin: 5px 0; padding-left: 20px;">
            <li>100% damage negation</li>
            <li>Enemy stun (1 second)</li>
            <li>Energy restore (+20)</li>
            <li>Score bonus (+50)</li>
        </ul>
        <div class="normal-block">üõ°Ô∏è Normal Block:</div>
        <ul style="margin: 5px 0; padding-left: 20px;">
            <li>50% damage reduction</li>
            <li>Reduced knockback</li>
        </ul>
        <hr style="border-color: #333; margin: 10px 0;">
        <div class="control">
            <span class="key">1</span> - Spawn Wolf (Debug)
        </div>
        <div class="control">
            <span class="key">ESC</span> - Pause
        </div>
    </div>
    
    <!-- Include the VFX system -->
    <script>
        // Minimal VFX system for particle effects
        class VFXSystem {
            constructor(ctx) {
                this.ctx = ctx;
                this.particles = [];
                this.screenShake = { intensity: 0, duration: 0 };
            }
            
            createParticle(x, y, vx, vy, color, lifetime) {
                this.particles.push({ x, y, vx, vy, color, lifetime, maxLifetime: lifetime });
            }
            
            createBoostTrail(x, y, color, velocity) {
                for (let i = 0; i < 3; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    this.createParticle(
                        x + Math.random() * 10 - 5,
                        y + Math.random() * 10 - 5,
                        -velocity.x * 0.5 + Math.cos(angle) * 2,
                        -velocity.y * 0.5 + Math.sin(angle) * 2,
                        color,
                        30
                    );
                }
            }
            
            createImpactEffect(x, y, color) {
                for (let i = 0; i < 10; i++) {
                    const angle = (Math.PI * 2 * i) / 10;
                    this.createParticle(
                        x, y,
                        Math.cos(angle) * 5,
                        Math.sin(angle) * 5,
                        color,
                        40
                    );
                }
            }
            
            createExplosion(x, y, color) {
                for (let i = 0; i < 20; i++) {
                    const angle = Math.random() * Math.PI * 2;
                    const speed = Math.random() * 8 + 2;
                    this.createParticle(
                        x, y,
                        Math.cos(angle) * speed,
                        Math.sin(angle) * speed,
                        color,
                        60
                    );
                }
            }
            
            createPowerUpEffect(x, y, type) {
                const color = type === 'health' ? '#ff00ff' : '#00ffff';
                this.createExplosion(x, y, color);
            }
            
            shakeScreen(intensity, duration) {
                this.screenShake.intensity = intensity;
                this.screenShake.duration = duration;
            }
            
            startScreenShake(intensity, duration) {
                this.shakeScreen(intensity, duration);
            }
            
            update(deltaTime) {
                // Update particles
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const p = this.particles[i];
                    p.x += p.vx;
                    p.y += p.vy;
                    p.lifetime--;
                    p.vx *= 0.98;
                    p.vy *= 0.98;
                    
                    if (p.lifetime <= 0) {
                        this.particles.splice(i, 1);
                    }
                }
                
                // Update screen shake
                if (this.screenShake.duration > 0) {
                    this.screenShake.duration -= deltaTime;
                }
            }
            
            render() {
                const ctx = this.ctx;
                
                // Apply screen shake
                if (this.screenShake.duration > 0) {
                    const shakeX = (Math.random() - 0.5) * this.screenShake.intensity;
                    const shakeY = (Math.random() - 0.5) * this.screenShake.intensity;
                    ctx.save();
                    ctx.translate(shakeX, shakeY);
                }
                
                // Render particles
                for (const p of this.particles) {
                    ctx.save();
                    ctx.globalAlpha = p.lifetime / p.maxLifetime;
                    ctx.fillStyle = p.color;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();
                }
                
                // Restore if shaking
                if (this.screenShake.duration > 0) {
                    ctx.restore();
                }
            }
        }
        
        // Inject VFX into window for the game to use
        window.VFXSystem = VFXSystem;
    </script>
    
    <!-- Include the game -->
    <script src="public/unified-game.js"></script>
    
    <script>
        // Initialize the game
        const canvas = document.getElementById('gameCanvas');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        // Create and start the game
        const game = new window.UnifiedGame(canvas);
        
        // Handle window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        
        // Start the game automatically
        setTimeout(() => {
            game.start();
        }, 100);
    </script>
</body>
</html>